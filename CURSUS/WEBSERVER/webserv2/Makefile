########################################
### Makefile for the webserv project ###
########################################

NAME = webserv

SRCS = srcs/main.cpp \
       srcs/Server.cpp \
       srcs/Config.cpp \
       srcs/Request.cpp \
       srcs/Response.cpp \
       srcs/CGI.cpp

OBJS = $(SRCS:srcs/%.cpp=obj/%.o)

CXX = c++
CXXFLAGS = -Wall -Wextra -Werror -std=c++98 -D_GLIBCXX_USE_CXX11_ABI=0

INC = -I include

all: $(NAME)

$(NAME): $(OBJS)
	@echo "Compiling $(NAME)... ‚è≥"
	$(CXX) $(CXXFLAGS) $(OBJS) -o $(NAME)
	@echo "$(NAME) compiled successfully! üéâ"

obj/%.o: srcs/%.cpp
	@if [ ! -d obj ]; then mkdir -p obj; echo "Creating object directory obj... üóÇÔ∏è"; echo "Object directory created. ‚úÖ"; fi
	@echo "Compiling $< into $@... üìÑ"
	$(CXX) $(CXXFLAGS) $(INC) -c $< -o $@
	@echo "$< compiled into $@ successfully. ‚úÖ"

clean:
	@echo "Cleaning object files... üßπ"
	rm -rf obj
	@echo "Object files cleaned! ‚úÖ"

fclean: clean
	@echo "Cleaning $(NAME)... üßπ"
	rm -f $(NAME)
	@echo "$(NAME) cleaned! ‚úÖ"

re: fclean all

.PHONY: all clean fclean re